MPI startup(): PMI server not found. Please set I_MPI_PMI_LIBRARY variable if it is not a singleton case.
Number of Layers frozen: 362
Total trainable parameters of the model: 93563910 (non-LoRa) vs 24576 (LoRa) Ratio: 0.03% of the original model
0
i 0 [1, 2]
1
i 1 [1, 2]
512
2
i 0 [1, 2]
3
i 1 [1, 2]
512
device cuda cuda
Started ...
tensor(0.9988, device='cuda:0', grad_fn=<MaxBackward1>) tensor(1., device='cuda:0')
tensor(0.0030, device='cuda:0', grad_fn=<MinBackward1>) tensor(0., device='cuda:0')
Logging to /tmp/openai-2024-08-12-21-11-43-701772
Parameter module.time_embed.0.weight require grad
Parameter module.time_embed.0.bias require grad
Parameter module.time_embed.2.weight require grad
Parameter module.time_embed.2.bias require grad
Parameter module.input_blocks.0.weight require grad
Parameter module.input_blocks.0.bias require grad
Parameter module.input_blocks.1.0.in_layers.0.weight require grad
Parameter module.input_blocks.1.0.in_layers.0.bias require grad
Parameter module.input_blocks.1.0.in_layers.2.weight require grad
Parameter module.input_blocks.1.0.in_layers.2.bias require grad
Parameter module.input_blocks.1.0.out_layers.0.weight require grad
Parameter module.input_blocks.1.0.out_layers.0.bias require grad
Parameter module.input_blocks.1.0.out_layers.3.weight require grad
Parameter module.input_blocks.1.0.out_layers.3.bias require grad
Parameter module.input_blocks.2.0.in_layers.0.weight require grad
Parameter module.input_blocks.2.0.in_layers.0.bias require grad
Parameter module.input_blocks.2.0.in_layers.2.weight require grad
Parameter module.input_blocks.2.0.in_layers.2.bias require grad
Parameter module.input_blocks.2.0.out_layers.0.weight require grad
Parameter module.input_blocks.2.0.out_layers.0.bias require grad
Parameter module.input_blocks.2.0.out_layers.3.weight require grad
Parameter module.input_blocks.2.0.out_layers.3.bias require grad
Parameter module.input_blocks.3.0.in_layers.0.weight require grad
Parameter module.input_blocks.3.0.in_layers.0.bias require grad
Parameter module.input_blocks.3.0.in_layers.2.weight require grad
Parameter module.input_blocks.3.0.in_layers.2.bias require grad
Parameter module.input_blocks.3.0.out_layers.0.weight require grad
Parameter module.input_blocks.3.0.out_layers.0.bias require grad
Parameter module.input_blocks.3.0.out_layers.3.weight require grad
Parameter module.input_blocks.3.0.out_layers.3.bias require grad
Parameter module.input_blocks.4.0.in_layers.0.weight require grad
Parameter module.input_blocks.4.0.in_layers.0.bias require grad
Parameter module.input_blocks.4.0.in_layers.2.weight require grad
Parameter module.input_blocks.4.0.in_layers.2.bias require grad
Parameter module.input_blocks.4.0.out_layers.0.weight require grad
Parameter module.input_blocks.4.0.out_layers.0.bias require grad
Parameter module.input_blocks.4.0.out_layers.3.weight require grad
Parameter module.input_blocks.4.0.out_layers.3.bias require grad
Parameter module.input_blocks.5.0.in_layers.0.weight require grad
Parameter module.input_blocks.5.0.in_layers.0.bias require grad
Parameter module.input_blocks.5.0.in_layers.2.weight require grad
Parameter module.input_blocks.5.0.in_layers.2.bias require grad
Parameter module.input_blocks.5.0.out_layers.0.weight require grad
Parameter module.input_blocks.5.0.out_layers.0.bias require grad
Parameter module.input_blocks.5.0.out_layers.3.weight require grad
Parameter module.input_blocks.5.0.out_layers.3.bias require grad
Parameter module.input_blocks.5.0.skip_connection.weight require grad
Parameter module.input_blocks.5.0.skip_connection.bias require grad
Parameter module.input_blocks.6.0.in_layers.0.weight require grad
Parameter module.input_blocks.6.0.in_layers.0.bias require grad
Parameter module.input_blocks.6.0.in_layers.2.weight require grad
Parameter module.input_blocks.6.0.in_layers.2.bias require grad
Parameter module.input_blocks.6.0.out_layers.0.weight require grad
Parameter module.input_blocks.6.0.out_layers.0.bias require grad
Parameter module.input_blocks.6.0.out_layers.3.weight require grad
Parameter module.input_blocks.6.0.out_layers.3.bias require grad
Parameter module.input_blocks.7.0.in_layers.0.weight require grad
Parameter module.input_blocks.7.0.in_layers.0.bias require grad
Parameter module.input_blocks.7.0.in_layers.2.weight require grad
Parameter module.input_blocks.7.0.in_layers.2.bias require grad
Parameter module.input_blocks.7.0.out_layers.0.weight require grad
Parameter module.input_blocks.7.0.out_layers.0.bias require grad
Parameter module.input_blocks.7.0.out_layers.3.weight require grad
Parameter module.input_blocks.7.0.out_layers.3.bias require grad
Parameter module.input_blocks.8.0.in_layers.0.weight require grad
Parameter module.input_blocks.8.0.in_layers.0.bias require grad
Parameter module.input_blocks.8.0.in_layers.2.weight require grad
Parameter module.input_blocks.8.0.in_layers.2.bias require grad
Parameter module.input_blocks.8.0.out_layers.0.weight require grad
Parameter module.input_blocks.8.0.out_layers.0.bias require grad
Parameter module.input_blocks.8.0.out_layers.3.weight require grad
Parameter module.input_blocks.8.0.out_layers.3.bias require grad
Parameter module.input_blocks.9.0.in_layers.0.weight require grad
Parameter module.input_blocks.9.0.in_layers.0.bias require grad
Parameter module.input_blocks.9.0.in_layers.2.weight require grad
Parameter module.input_blocks.9.0.in_layers.2.bias require grad
Parameter module.input_blocks.9.0.out_layers.0.weight require grad
Parameter module.input_blocks.9.0.out_layers.0.bias require grad
Parameter module.input_blocks.9.0.out_layers.3.weight require grad
Parameter module.input_blocks.9.0.out_layers.3.bias require grad
Parameter module.input_blocks.9.0.skip_connection.weight require grad
Parameter module.input_blocks.9.0.skip_connection.bias require grad
Parameter module.input_blocks.10.0.in_layers.0.weight require grad
Parameter module.input_blocks.10.0.in_layers.0.bias require grad
Parameter module.input_blocks.10.0.in_layers.2.weight require grad
Parameter module.input_blocks.10.0.in_layers.2.bias require grad
Parameter module.input_blocks.10.0.out_layers.0.weight require grad
Parameter module.input_blocks.10.0.out_layers.0.bias require grad
Parameter module.input_blocks.10.0.out_layers.3.weight require grad
Parameter module.input_blocks.10.0.out_layers.3.bias require grad
Parameter module.input_blocks.11.0.in_layers.0.weight require grad
Parameter module.input_blocks.11.0.in_layers.0.bias require grad
Parameter module.input_blocks.11.0.in_layers.2.weight require grad
Parameter module.input_blocks.11.0.in_layers.2.bias require grad
Parameter module.input_blocks.11.0.out_layers.0.weight require grad
Parameter module.input_blocks.11.0.out_layers.0.bias require grad
Parameter module.input_blocks.11.0.out_layers.3.weight require grad
Parameter module.input_blocks.11.0.out_layers.3.bias require grad
Parameter module.middle_block.0.in_layers.0.weight require grad
Parameter module.middle_block.0.in_layers.0.bias require grad
Parameter module.middle_block.0.in_layers.2.weight require grad
Parameter module.middle_block.0.in_layers.2.bias require grad
Parameter module.middle_block.0.out_layers.0.weight require grad
Parameter module.middle_block.0.out_layers.0.bias require grad
Parameter module.middle_block.0.out_layers.3.weight require grad
Parameter module.middle_block.0.out_layers.3.bias require grad
Parameter module.output_blocks.0.0.in_layers.0.weight require grad
Parameter module.output_blocks.0.0.in_layers.0.bias require grad
Parameter module.output_blocks.0.0.in_layers.2.weight require grad
Parameter module.output_blocks.0.0.in_layers.2.bias require grad
Parameter module.output_blocks.0.0.out_layers.0.weight require grad
Parameter module.output_blocks.0.0.out_layers.0.bias require grad
Parameter module.output_blocks.0.0.out_layers.3.weight require grad
Parameter module.output_blocks.0.0.out_layers.3.bias require grad
Parameter module.output_blocks.0.0.skip_connection.weight require grad
Parameter module.output_blocks.0.0.skip_connection.bias require grad
Parameter module.output_blocks.1.0.in_layers.0.weight require grad
Parameter module.output_blocks.1.0.in_layers.0.bias require grad
Parameter module.output_blocks.1.0.in_layers.2.weight require grad
Parameter module.output_blocks.1.0.in_layers.2.bias require grad
Parameter module.output_blocks.1.0.out_layers.0.weight require grad
Parameter module.output_blocks.1.0.out_layers.0.bias require grad
Parameter module.output_blocks.1.0.out_layers.3.weight require grad
Parameter module.output_blocks.1.0.out_layers.3.bias require grad
Parameter module.output_blocks.1.0.skip_connection.weight require grad
Parameter module.output_blocks.1.0.skip_connection.bias require grad
Parameter module.output_blocks.1.1.in_layers.0.weight require grad
Parameter module.output_blocks.1.1.in_layers.0.bias require grad
Parameter module.output_blocks.1.1.in_layers.2.weight require grad
Parameter module.output_blocks.1.1.in_layers.2.bias require grad
Parameter module.output_blocks.1.1.out_layers.0.weight require grad
Parameter module.output_blocks.1.1.out_layers.0.bias require grad
Parameter module.output_blocks.1.1.out_layers.3.weight require grad
Parameter module.output_blocks.1.1.out_layers.3.bias require grad
Parameter module.output_blocks.2.0.in_layers.0.weight require grad
Parameter module.output_blocks.2.0.in_layers.0.bias require grad
Parameter module.output_blocks.2.0.in_layers.2.weight require grad
Parameter module.output_blocks.2.0.in_layers.2.bias require grad
Parameter module.output_blocks.2.0.out_layers.0.weight require grad
Parameter module.output_blocks.2.0.out_layers.0.bias require grad
Parameter module.output_blocks.2.0.out_layers.3.weight require grad
Parameter module.output_blocks.2.0.out_layers.3.bias require grad
Parameter module.output_blocks.2.0.skip_connection.weight require grad
Parameter module.output_blocks.2.0.skip_connection.bias require grad
Parameter module.output_blocks.3.0.in_layers.0.weight require grad
Parameter module.output_blocks.3.0.in_layers.0.bias require grad
Parameter module.output_blocks.3.0.in_layers.2.weight require grad
Parameter module.output_blocks.3.0.in_layers.2.bias require grad
Parameter module.output_blocks.3.0.out_layers.0.weight require grad
Parameter module.output_blocks.3.0.out_layers.0.bias require grad
Parameter module.output_blocks.3.0.out_layers.3.weight require grad
Parameter module.output_blocks.3.0.out_layers.3.bias require grad
Parameter module.output_blocks.3.0.skip_connection.weight require grad
Parameter module.output_blocks.3.0.skip_connection.bias require grad
Parameter module.output_blocks.3.1.in_layers.0.weight require grad
Parameter module.output_blocks.3.1.in_layers.0.bias require grad
Parameter module.output_blocks.3.1.in_layers.2.weight require grad
Parameter module.output_blocks.3.1.in_layers.2.bias require grad
Parameter module.output_blocks.3.1.out_layers.0.weight require grad
Parameter module.output_blocks.3.1.out_layers.0.bias require grad
Parameter module.output_blocks.3.1.out_layers.3.weight require grad
Parameter module.output_blocks.3.1.out_layers.3.bias require grad
Parameter module.model.input_blocks.9.1.qkv.parametrizations.weight.0.lora_A require grad
Parameter module.model.input_blocks.9.1.qkv.parametrizations.weight.0.lora_B require grad
Parameter module.model.input_blocks.9.1.proj_out.parametrizations.weight.0.lora_A require grad
Parameter module.model.input_blocks.9.1.proj_out.parametrizations.weight.0.lora_B require grad
Parameter module.model.middle_block.1.qkv.parametrizations.weight.0.lora_A require grad
Parameter module.model.middle_block.1.qkv.parametrizations.weight.0.lora_B require grad
Parameter module.model.middle_block.1.proj_out.parametrizations.weight.0.lora_A require grad
Parameter module.model.middle_block.1.proj_out.parametrizations.weight.0.lora_B require grad
Parameter module.model.output_blocks.2.1.qkv.parametrizations.weight.0.lora_A require grad
Parameter module.model.output_blocks.2.1.qkv.parametrizations.weight.0.lora_B require grad
Parameter module.model.output_blocks.2.1.proj_out.parametrizations.weight.0.lora_A require grad
Parameter module.model.output_blocks.2.1.proj_out.parametrizations.weight.0.lora_B require grad
Parameter module.model.output_blocks.3.1.qkv.parametrizations.weight.0.lora_A require grad
Parameter module.model.output_blocks.3.1.qkv.parametrizations.weight.0.lora_B require grad
Parameter module.model.output_blocks.3.1.proj_out.parametrizations.weight.0.lora_A require grad
Parameter module.model.output_blocks.3.1.proj_out.parametrizations.weight.0.lora_B require grad
