Started ...
tensor(0.7238, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0.9380, device='cuda:0')
tensor(0.0095, device='cuda:0', grad_fn=<MinBackward1>) tensor(-1., device='cuda:0')
Traceback (most recent call last):
  File "/users/cmk2000/cmk2000/Deep learning models/LLMs/Conditional-Diffusion-Models-for-IVP/main_training.py", line 90, in <module>
    main()
  File "/users/cmk2000/cmk2000/Deep learning models/LLMs/Conditional-Diffusion-Models-for-IVP/main_training.py", line 87, in main
    trainer.run_training_loop(num_epochs)
  File "/users/cmk2000/cmk2000/Deep learning models/LLMs/Conditional-Diffusion-Models-for-IVP/models/trainer.py", line 222, in run_training_loop
    self.run_epoch(batch_data, batch_sol_Tk, batch_y, blur_kernel_op)
  File "/users/cmk2000/cmk2000/Deep learning models/LLMs/Conditional-Diffusion-Models-for-IVP/models/trainer.py", line 254, in run_epoch
    self.run_forward_backward(batch_data, batch_sol_Tk, batch_y, blur_kernel_op)
  File "/users/cmk2000/cmk2000/Deep learning models/LLMs/Conditional-Diffusion-Models-for-IVP/models/trainer.py", line 281, in run_forward_backward
    losses_x_cons = self.ddp_model.module.consistency_loss(x_pred, batch_y, blur_kernel_op)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/users/cmk2000/cmk2000/Deep learning models/LLMs/Conditional-Diffusion-Models-for-IVP/models/model.py", line 467, in consistency_loss
    loss = self.loss_weight * nn.MSELoss(Ax_pred, y)
                              ^^^^^^^^^^^^^^^^^^^^^^
  File "/users/cmk2000/.conda/envs/dmog_env39/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 535, in __init__
    super().__init__(size_average, reduce, reduction)
  File "/users/cmk2000/.conda/envs/dmog_env39/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 23, in __init__
    self.reduction: str = _Reduction.legacy_get_string(size_average, reduce)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/users/cmk2000/.conda/envs/dmog_env39/lib/python3.12/site-packages/torch/nn/_reduction.py", line 35, in legacy_get_string
    if size_average and reduce:
       ^^^^^^^^^^^^
RuntimeError: Boolean value of Tensor with more than one value is ambiguous
[rank0]: Traceback (most recent call last):
[rank0]:   File "/users/cmk2000/cmk2000/Deep learning models/LLMs/Conditional-Diffusion-Models-for-IVP/main_training.py", line 90, in <module>
[rank0]:     main()
[rank0]:   File "/users/cmk2000/cmk2000/Deep learning models/LLMs/Conditional-Diffusion-Models-for-IVP/main_training.py", line 87, in main
[rank0]:     trainer.run_training_loop(num_epochs)
[rank0]:   File "/users/cmk2000/cmk2000/Deep learning models/LLMs/Conditional-Diffusion-Models-for-IVP/models/trainer.py", line 222, in run_training_loop
[rank0]:     self.run_epoch(batch_data, batch_sol_Tk, batch_y, blur_kernel_op)
[rank0]:   File "/users/cmk2000/cmk2000/Deep learning models/LLMs/Conditional-Diffusion-Models-for-IVP/models/trainer.py", line 254, in run_epoch
[rank0]:     self.run_forward_backward(batch_data, batch_sol_Tk, batch_y, blur_kernel_op)
[rank0]:   File "/users/cmk2000/cmk2000/Deep learning models/LLMs/Conditional-Diffusion-Models-for-IVP/models/trainer.py", line 281, in run_forward_backward
[rank0]:     losses_x_cons = self.ddp_model.module.consistency_loss(x_pred, batch_y, blur_kernel_op)
[rank0]:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/users/cmk2000/cmk2000/Deep learning models/LLMs/Conditional-Diffusion-Models-for-IVP/models/model.py", line 467, in consistency_loss
[rank0]:     loss = self.loss_weight * nn.MSELoss(Ax_pred, y)
[rank0]:                               ^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/users/cmk2000/.conda/envs/dmog_env39/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 535, in __init__
[rank0]:     super().__init__(size_average, reduce, reduction)
[rank0]:   File "/users/cmk2000/.conda/envs/dmog_env39/lib/python3.12/site-packages/torch/nn/modules/loss.py", line 23, in __init__
[rank0]:     self.reduction: str = _Reduction.legacy_get_string(size_average, reduce)
[rank0]:                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/users/cmk2000/.conda/envs/dmog_env39/lib/python3.12/site-packages/torch/nn/_reduction.py", line 35, in legacy_get_string
[rank0]:     if size_average and reduce:
[rank0]:        ^^^^^^^^^^^^
[rank0]: RuntimeError: Boolean value of Tensor with more than one value is ambiguous