2024-08-19 17:24:01,037 - INFO - Epoch ==== >> 0
2024-08-19 17:24:01,286 - INFO -
2024-08-19 17:24:01,287 - INFO - -----------------------------------------------------------
2024-08-19 17:24:01,288 - INFO - -----------------------------------------------------------
2024-08-19 17:24:01,289 - INFO - Memory usage: 1224.12109375 MB
2024-08-19 17:24:01,290 - INFO - -----------------------------------------------------------
2024-08-19 17:24:01,290 - INFO - -----------------------------------------------------------
2024-08-19 17:24:01,291 - INFO -
2024-08-19 17:24:01,291 - INFO - Epoch ==== >> 0	|	 batch ==== >> 0
2024-08-19 17:24:01,748 - INFO - Loss: 0.1162455826997757
Started ...
Traceback (most recent call last):
  File "/users/cmk2000/cmk2000/Deep learning models/LLMs/Conditional-Diffusion-Models-for-IVP/main_training_accelerate.py", line 104, in <module>
    main()
  File "/users/cmk2000/cmk2000/Deep learning models/LLMs/Conditional-Diffusion-Models-for-IVP/main_training_accelerate.py", line 97, in main
    trainer_accelerate.run_training_loop(num_epochs)
  File "/users/cmk2000/.conda/envs/dmog_env39/lib/python3.12/site-packages/memory_profiler.py", line 1188, in wrapper
    val = prof(func)(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/users/cmk2000/.conda/envs/dmog_env39/lib/python3.12/site-packages/memory_profiler.py", line 761, in f
    return func(*args, **kwds)
           ^^^^^^^^^^^^^^^^^^^
  File "/users/cmk2000/cmk2000/Deep learning models/LLMs/Conditional-Diffusion-Models-for-IVP/models/trainer_accelerate.py", line 230, in run_training_loop
    self.run_epoch(batch_data, batch_sol_Tk, batch_y, blur_kernel_op, epoch)
  File "/users/cmk2000/.conda/envs/dmog_env39/lib/python3.12/site-packages/memory_profiler.py", line 1188, in wrapper
    val = prof(func)(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/users/cmk2000/.conda/envs/dmog_env39/lib/python3.12/site-packages/memory_profiler.py", line 761, in f
    return func(*args, **kwds)
           ^^^^^^^^^^^^^^^^^^^
  File "/users/cmk2000/cmk2000/Deep learning models/LLMs/Conditional-Diffusion-Models-for-IVP/models/trainer_accelerate.py", line 271, in run_epoch
    self.run_forward_backward(batch_data, batch_sol_Tk, batch_y, blur_kernel_op)
  File "/users/cmk2000/.conda/envs/dmog_env39/lib/python3.12/site-packages/memory_profiler.py", line 1188, in wrapper
    val = prof(func)(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/users/cmk2000/.conda/envs/dmog_env39/lib/python3.12/site-packages/memory_profiler.py", line 761, in f
    return func(*args, **kwds)
           ^^^^^^^^^^^^^^^^^^^
  File "/users/cmk2000/cmk2000/Deep learning models/LLMs/Conditional-Diffusion-Models-for-IVP/models/trainer_accelerate.py", line 338, in run_forward_backward
    self.accelerator.backward(loss)
  File "/users/cmk2000/.conda/envs/dmog_env39/lib/python3.12/site-packages/accelerate/accelerator.py", line 2159, in backward
    loss.backward(**kwargs)
  File "/users/cmk2000/.conda/envs/dmog_env39/lib/python3.12/site-packages/torch/_tensor.py", line 521, in backward
    torch.autograd.backward(
  File "/users/cmk2000/.conda/envs/dmog_env39/lib/python3.12/site-packages/torch/autograd/__init__.py", line 282, in backward
    grad_tensors_ = _make_grads(tensors, grad_tensors_, is_grads_batched=False)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/users/cmk2000/.conda/envs/dmog_env39/lib/python3.12/site-packages/torch/autograd/__init__.py", line 151, in _make_grads
    raise RuntimeError(
RuntimeError: grad can be implicitly created only for scalar outputs
[rank0]: Traceback (most recent call last):
[rank0]:   File "/users/cmk2000/cmk2000/Deep learning models/LLMs/Conditional-Diffusion-Models-for-IVP/main_training_accelerate.py", line 104, in <module>
[rank0]:     main()
[rank0]:   File "/users/cmk2000/cmk2000/Deep learning models/LLMs/Conditional-Diffusion-Models-for-IVP/main_training_accelerate.py", line 97, in main
[rank0]:     trainer_accelerate.run_training_loop(num_epochs)
[rank0]:   File "/users/cmk2000/.conda/envs/dmog_env39/lib/python3.12/site-packages/memory_profiler.py", line 1188, in wrapper
[rank0]:     val = prof(func)(*args, **kwargs)
[rank0]:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/users/cmk2000/.conda/envs/dmog_env39/lib/python3.12/site-packages/memory_profiler.py", line 761, in f
[rank0]:     return func(*args, **kwds)
[rank0]:            ^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/users/cmk2000/cmk2000/Deep learning models/LLMs/Conditional-Diffusion-Models-for-IVP/models/trainer_accelerate.py", line 230, in run_training_loop
[rank0]:     self.run_epoch(batch_data, batch_sol_Tk, batch_y, blur_kernel_op, epoch)
[rank0]:   File "/users/cmk2000/.conda/envs/dmog_env39/lib/python3.12/site-packages/memory_profiler.py", line 1188, in wrapper
[rank0]:     val = prof(func)(*args, **kwargs)
[rank0]:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/users/cmk2000/.conda/envs/dmog_env39/lib/python3.12/site-packages/memory_profiler.py", line 761, in f
[rank0]:     return func(*args, **kwds)
[rank0]:            ^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/users/cmk2000/cmk2000/Deep learning models/LLMs/Conditional-Diffusion-Models-for-IVP/models/trainer_accelerate.py", line 271, in run_epoch
[rank0]:     self.run_forward_backward(batch_data, batch_sol_Tk, batch_y, blur_kernel_op)
[rank0]:   File "/users/cmk2000/.conda/envs/dmog_env39/lib/python3.12/site-packages/memory_profiler.py", line 1188, in wrapper
[rank0]:     val = prof(func)(*args, **kwargs)
[rank0]:           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/users/cmk2000/.conda/envs/dmog_env39/lib/python3.12/site-packages/memory_profiler.py", line 761, in f
[rank0]:     return func(*args, **kwds)
[rank0]:            ^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/users/cmk2000/cmk2000/Deep learning models/LLMs/Conditional-Diffusion-Models-for-IVP/models/trainer_accelerate.py", line 338, in run_forward_backward
[rank0]:     self.accelerator.backward(loss)
[rank0]:   File "/users/cmk2000/.conda/envs/dmog_env39/lib/python3.12/site-packages/accelerate/accelerator.py", line 2159, in backward
[rank0]:     loss.backward(**kwargs)
[rank0]:   File "/users/cmk2000/.conda/envs/dmog_env39/lib/python3.12/site-packages/torch/_tensor.py", line 521, in backward
[rank0]:     torch.autograd.backward(
[rank0]:   File "/users/cmk2000/.conda/envs/dmog_env39/lib/python3.12/site-packages/torch/autograd/__init__.py", line 282, in backward
[rank0]:     grad_tensors_ = _make_grads(tensors, grad_tensors_, is_grads_batched=False)
[rank0]:                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/users/cmk2000/.conda/envs/dmog_env39/lib/python3.12/site-packages/torch/autograd/__init__.py", line 151, in _make_grads
[rank0]:     raise RuntimeError(
[rank0]: RuntimeError: grad can be implicitly created only for scalar outputs