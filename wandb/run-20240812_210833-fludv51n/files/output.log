Started ...
tensor(0.9528, device='cuda:0', grad_fn=<MaxBackward1>) tensor(1., device='cuda:0')
tensor(0.0065, device='cuda:0', grad_fn=<MinBackward1>) tensor(0., device='cuda:0')
Logging to /tmp/openai-2024-08-12-21-08-37-373951
tensor([[[[-3.4057e-11, -4.6813e-11, -2.5064e-11,  ..., -6.1257e-11,
           -8.4241e-11, -1.0281e-10],
          [-2.6036e-10, -5.5681e-11, -1.1040e-10,  ..., -4.3685e-11,
           -2.0565e-11,  3.5141e-11],
          [-2.0790e-10, -1.2714e-10, -4.1165e-11,  ...,  3.5022e-11,
           -1.2309e-10,  7.8403e-11],
          ...,
          [-1.5189e-11, -4.6703e-11, -6.2303e-11,  ...,  1.8634e-10,
            5.4641e-11,  1.6856e-10],
          [-4.2979e-11, -1.2947e-11, -9.6159e-11,  ...,  1.5740e-10,
           -5.4058e-12,  1.2517e-10],
          [-4.9523e-11, -1.1143e-10, -1.5403e-10,  ...,  9.3317e-12,
            5.5116e-11,  6.6392e-11]],
         [[ 1.5172e-10,  1.1619e-10,  2.7522e-11,  ..., -4.0364e-11,
           -3.3942e-12, -9.9661e-11],
          [-1.3540e-10, -1.1335e-10,  8.6818e-11,  ..., -4.0231e-11,
           -2.8965e-11,  3.5613e-11],
          [-1.1407e-10, -2.2637e-11, -1.2199e-10,  ..., -1.2525e-10,
            1.9911e-10,  4.3772e-11],
          ...,
          [ 7.0752e-11, -4.7089e-12, -3.6049e-11,  ..., -6.7688e-11,
            9.0798e-11, -1.1328e-10],
          [ 2.1907e-11, -3.0921e-11, -1.9508e-10,  ..., -1.6081e-10,
            2.0525e-11, -6.0898e-11],
          [-4.7081e-11, -9.0997e-11, -1.3171e-10,  ...,  6.1451e-11,
           -1.2545e-11, -1.0073e-10]],
         [[-1.0105e-10, -9.2168e-11, -9.3483e-11,  ...,  2.3578e-11,
            4.3241e-11, -3.0291e-11],
          [-2.0116e-10, -6.5596e-11, -4.5779e-11,  ..., -2.8172e-12,
            1.1560e-10,  5.6433e-11],
          [-1.3560e-10, -1.2094e-10,  1.3798e-11,  ...,  1.4924e-11,
            7.9560e-11,  8.9715e-11],
          ...,
          [-3.1994e-11,  1.1066e-10, -1.0433e-10,  ...,  3.6092e-11,
           -2.1188e-11,  5.3543e-07],
          [-6.1867e-11, -1.3185e-10, -3.4823e-11,  ...,  8.1739e-11,
            7.6525e-11, -6.6676e-11],
          [-1.5197e-10, -6.7236e-11, -7.0401e-11,  ...,  4.2810e-11,
            1.6442e-11, -1.2941e-10]]],
        [[[ 2.9944e-10,  2.7015e-10, -1.2148e-10,  ...,  5.0139e-07,
            5.0195e-07,  3.0088e-10],
          [-1.4533e-10, -4.4607e-11, -3.9400e-10,  ...,  1.3460e-09,
           -3.0048e-10, -6.9796e-11],
          [-2.5891e-10, -4.8672e-11,  2.3076e-10,  ...,  5.7259e-10,
           -1.0839e-10,  5.0082e-07],
          ...,
          [ 1.7008e-10,  1.8566e-10,  4.9416e-07,  ..., -8.5574e-10,
           -1.0072e-09, -2.7147e-10],
          [ 4.9968e-07, -1.5224e-10,  4.9805e-07,  ..., -4.5104e-10,
           -9.3452e-10, -8.0384e-10],
          [-1.1072e-09, -7.7436e-10, -3.4040e-10,  ..., -5.4465e-10,
           -1.0717e-09, -1.1920e-09]],
         [[ 3.3358e-10,  5.0885e-07,  4.9797e-07,  ...,  5.6819e-10,
            7.1131e-10,  3.5120e-10],
          [ 5.1970e-07, -5.6033e-10,  5.3660e-10,  ...,  5.4804e-07,
            4.2055e-10, -1.2408e-12],
          [-9.6601e-11, -1.1567e-10, -5.5991e-10,  ...,  6.7475e-10,
            3.3626e-10,  4.7510e-10],
          ...,
          [-3.9963e-10,  4.9678e-07, -6.1231e-10,  ..., -3.9397e-10,
            6.3928e-10, -3.8658e-10],
          [-2.6953e-10,  1.4868e-10, -2.6600e-10,  ..., -5.2783e-10,
           -1.8049e-10, -4.7011e-10],
          [-5.5324e-10, -4.8197e-10,  4.9489e-07,  ..., -8.3384e-11,
           -7.6522e-10, -5.5799e-10]],
         [[ 4.4413e-07, -3.5512e-10, -1.2784e-10,  ..., -2.4359e-10,
           -5.0253e-10, -5.9021e-10],
          [-1.8433e-10,  2.6528e-10, -5.1669e-10,  ..., -3.1202e-10,
           -4.8924e-10, -6.0817e-10],
          [ 4.4394e-07,  4.2841e-07,  4.1215e-07,  ...,  2.5742e-10,
           -4.2169e-10, -6.8239e-10],
          ...,
          [-8.5220e-10, -5.1189e-10, -2.0054e-10,  ...,  3.0456e-10,
           -3.7427e-10,  6.1068e-10],
          [-3.9356e-10, -5.1693e-10, -3.9622e-10,  ...,  2.3218e-10,
           -1.2213e-10,  3.2627e-10],
          [-1.3104e-09, -9.4830e-10,  4.0379e-07,  ...,  4.9460e-07,
            4.7885e-07,  7.2435e-10]]],
        [[[ 1.3320e-07,  1.3459e-07, -3.8095e-10,  ..., -3.3340e-09,
           -4.9042e-10, -1.3465e-10],
          [ 1.3666e-07,  1.3578e-07,  1.3252e-07,  ..., -4.9738e-09,
           -3.0930e-09,  1.2880e-07],
          [ 1.3647e-07,  1.3330e-07,  1.3094e-07,  ...,  1.1115e-07,
           -1.5813e-09,  1.2660e-07],
          ...,
          [ 1.2138e-07,  1.2803e-07,  1.2271e-07,  ..., -8.1051e-11,
            1.0944e-07,  1.1751e-07],
          [ 1.3129e-07,  1.3047e-07,  1.2736e-07,  ...,  1.0934e-07,
            1.1776e-07,  1.2805e-07],
          [ 1.3564e-07,  1.3780e-07,  1.3080e-07,  ...,  1.1360e-07,
            1.2463e-07,  1.3590e-07]],
         [[-2.5700e-09, -1.4130e-09,  1.0328e-07,  ..., -2.5007e-09,
            1.2191e-07,  1.1866e-07],
          [-2.0334e-09,  1.0670e-07, -3.5773e-09,  ...,  1.2612e-07,
           -1.4613e-09,  1.1770e-07],
          [ 1.1185e-07,  1.0846e-07,  1.0530e-07,  ..., -4.0770e-09,
           -2.7669e-09,  1.1468e-07],
          ...,
          [-1.1785e-09, -3.6188e-09,  1.0747e-07,  ..., -6.9245e-10,
            1.1995e-07,  1.1560e-07],
          [-4.7824e-10,  1.0914e-07,  1.0320e-07,  ...,  1.2306e-07,
            1.2099e-07,  1.1815e-07],
          [ 1.1153e-07,  1.0581e-07, -6.0025e-09,  ...,  1.2640e-07,
            1.2396e-07,  1.1897e-07]],
         [[ 1.8176e-07,  1.8424e-07,  1.7947e-07,  ..., -1.2027e-09,
            1.6689e-07,  1.7787e-07],
          [ 1.8399e-07,  1.7686e-07,  1.8096e-07,  ..., -2.3989e-09,
            1.6826e-07,  1.7465e-07],
          [ 1.8161e-07,  1.7822e-07,  1.7305e-07,  ...,  1.5938e-07,
            1.6449e-07,  1.7220e-07],
          ...,
          [ 1.6304e-07,  1.6657e-07,  1.5853e-07,  ...,  1.4833e-07,
           -2.9512e-10,  1.6045e-07],
          [-7.5184e-11,  1.6911e-07,  1.6666e-07,  ...,  1.5224e-07,
            1.6227e-07,  1.6998e-07],
          [ 1.7395e-07,  1.7537e-07,  1.6960e-07,  ...,  1.5961e-07,
            1.6702e-07,  1.7543e-07]]],
        [[[ 1.0108e-07,  1.3437e-07,  1.3485e-07,  ...,  1.5305e-07,
            1.4337e-07,  1.3085e-07],
          [ 8.5043e-08,  1.0903e-07,  1.2153e-07,  ...,  1.2785e-07,
            1.2358e-07,  1.2513e-07],
          [ 9.1179e-08,  9.2712e-08,  9.1990e-08,  ...,  9.9342e-08,
            1.0345e-07,  1.0504e-07],
          ...,
          [ 1.6532e-07,  1.4122e-07,  1.2696e-07,  ..., -6.2539e-09,
            1.5274e-07,  1.4925e-07],
          [ 1.3584e-07,  1.2643e-07,  1.2134e-07,  ...,  1.4654e-07,
            1.6367e-07,  1.7722e-07],
          [ 9.5541e-08,  8.4999e-08,  9.7656e-08,  ..., -6.1021e-09,
           -1.6533e-09,  1.3594e-07]],
         [[ 9.4691e-08,  8.7955e-08,  8.5910e-08,  ...,  1.1114e-07,
            9.6311e-08,  1.1549e-07],
          [ 7.1558e-08,  7.4549e-08,  7.1219e-08,  ...,  7.7531e-08,
            9.0229e-08,  9.0357e-08],
          [ 5.7206e-08,  5.7743e-08,  5.7488e-08,  ...,  8.6335e-08,
            5.8387e-08,  7.8483e-08],
          ...,
          [ 1.1182e-07,  9.3223e-08,  9.7930e-08,  ...,  1.4713e-07,
           -5.2389e-09, -2.2850e-08],
          [ 1.1250e-07,  9.3534e-08,  7.6307e-08,  ...,  1.4268e-07,
            1.3031e-07,  1.3575e-07],
          [ 8.8011e-08,  8.6959e-08,  7.9478e-08,  ...,  1.2848e-07,
            1.2895e-07,  1.3096e-07]],
         [[-1.7624e-08,  1.0072e-07, -3.0638e-08,  ...,  1.2107e-07,
            1.3446e-07,  1.6712e-07],
          [ 1.1317e-07,  1.1152e-07,  8.7301e-08,  ...,  1.1414e-07,
            1.2795e-07,  1.2917e-07],
          [ 1.0013e-07,  9.2115e-08,  9.0031e-08,  ...,  9.1227e-08,
            1.1457e-07,  1.2357e-07],
          ...,
          [ 1.2377e-07,  1.1416e-07,  8.2961e-08,  ...,  1.4603e-07,
           -2.0491e-09,  1.5344e-07],
          [ 1.2896e-07,  1.0890e-07,  1.0611e-07,  ...,  1.4775e-07,
            1.5013e-07,  1.6209e-07],
          [ 3.9941e-08,  1.1306e-07,  9.0379e-08,  ..., -6.3408e-09,
            1.3823e-07,  1.4895e-07]]]], device='cuda:0')
Traceback (most recent call last):
  File "/users/cmk2000/cmk2000/Deep learning models/LLMs/Conditional-Diffusion-Models-for-IVP/main_training.py", line 90, in <module>
    main()
  File "/users/cmk2000/cmk2000/Deep learning models/LLMs/Conditional-Diffusion-Models-for-IVP/main_training.py", line 87, in main
    trainer.run_training_loop(num_epochs)
  File "/users/cmk2000/cmk2000/Deep learning models/LLMs/Conditional-Diffusion-Models-for-IVP/models/trainer.py", line 222, in run_training_loop
    self.run_epoch(batch_data, batch_sol_Tk, batch_y, blur_kernel_op)
  File "/users/cmk2000/cmk2000/Deep learning models/LLMs/Conditional-Diffusion-Models-for-IVP/models/trainer.py", line 254, in run_epoch
    self.run_forward_backward(batch_data, batch_sol_Tk, batch_y, blur_kernel_op)
  File "/users/cmk2000/cmk2000/Deep learning models/LLMs/Conditional-Diffusion-Models-for-IVP/models/trainer.py", line 301, in run_forward_backward
    self.mp_trainer.backward(loss)
  File "/users/cmk2000/cmk2000/Deep learning models/LLMs/Conditional-Diffusion-Models-for-IVP/models/fp16_util.py", line 180, in backward
    loss.backward()
  File "/users/cmk2000/.conda/envs/dmog_env39/lib/python3.12/site-packages/torch/_tensor.py", line 521, in backward
    torch.autograd.backward(
  File "/users/cmk2000/.conda/envs/dmog_env39/lib/python3.12/site-packages/torch/autograd/__init__.py", line 289, in backward
    _engine_run_backward(
  File "/users/cmk2000/.conda/envs/dmog_env39/lib/python3.12/site-packages/torch/autograd/graph.py", line 768, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/users/cmk2000/.conda/envs/dmog_env39/lib/python3.12/site-packages/torch/autograd/function.py", line 306, in apply
    return user_fn(self, *args)
           ^^^^^^^^^^^^^^^^^^^^
  File "/users/cmk2000/cmk2000/Deep learning models/LLMs/Conditional-Diffusion-Models-for-IVP/guided_diffusion/nn.py", line 177, in backward
    input_grads = torch.autograd.grad(
                  ^^^^^^^^^^^^^^^^^^^^
  File "/users/cmk2000/.conda/envs/dmog_env39/lib/python3.12/site-packages/torch/autograd/__init__.py", line 436, in grad
    result = _engine_run_backward(
             ^^^^^^^^^^^^^^^^^^^^^
  File "/users/cmk2000/.conda/envs/dmog_env39/lib/python3.12/site-packages/torch/autograd/graph.py", line 768, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: One of the differentiated Tensors does not require grad
[rank0]: Traceback (most recent call last):
[rank0]:   File "/users/cmk2000/cmk2000/Deep learning models/LLMs/Conditional-Diffusion-Models-for-IVP/main_training.py", line 90, in <module>
[rank0]:     main()
[rank0]:   File "/users/cmk2000/cmk2000/Deep learning models/LLMs/Conditional-Diffusion-Models-for-IVP/main_training.py", line 87, in main
[rank0]:     trainer.run_training_loop(num_epochs)
[rank0]:   File "/users/cmk2000/cmk2000/Deep learning models/LLMs/Conditional-Diffusion-Models-for-IVP/models/trainer.py", line 222, in run_training_loop
[rank0]:     self.run_epoch(batch_data, batch_sol_Tk, batch_y, blur_kernel_op)
[rank0]:   File "/users/cmk2000/cmk2000/Deep learning models/LLMs/Conditional-Diffusion-Models-for-IVP/models/trainer.py", line 254, in run_epoch
[rank0]:     self.run_forward_backward(batch_data, batch_sol_Tk, batch_y, blur_kernel_op)
[rank0]:   File "/users/cmk2000/cmk2000/Deep learning models/LLMs/Conditional-Diffusion-Models-for-IVP/models/trainer.py", line 301, in run_forward_backward
[rank0]:     self.mp_trainer.backward(loss)
[rank0]:   File "/users/cmk2000/cmk2000/Deep learning models/LLMs/Conditional-Diffusion-Models-for-IVP/models/fp16_util.py", line 180, in backward
[rank0]:     loss.backward()
[rank0]:   File "/users/cmk2000/.conda/envs/dmog_env39/lib/python3.12/site-packages/torch/_tensor.py", line 521, in backward
[rank0]:     torch.autograd.backward(
[rank0]:   File "/users/cmk2000/.conda/envs/dmog_env39/lib/python3.12/site-packages/torch/autograd/__init__.py", line 289, in backward
[rank0]:     _engine_run_backward(
[rank0]:   File "/users/cmk2000/.conda/envs/dmog_env39/lib/python3.12/site-packages/torch/autograd/graph.py", line 768, in _engine_run_backward
[rank0]:     return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/users/cmk2000/.conda/envs/dmog_env39/lib/python3.12/site-packages/torch/autograd/function.py", line 306, in apply
[rank0]:     return user_fn(self, *args)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/users/cmk2000/cmk2000/Deep learning models/LLMs/Conditional-Diffusion-Models-for-IVP/guided_diffusion/nn.py", line 177, in backward
[rank0]:     input_grads = torch.autograd.grad(
[rank0]:                   ^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/users/cmk2000/.conda/envs/dmog_env39/lib/python3.12/site-packages/torch/autograd/__init__.py", line 436, in grad
[rank0]:     result = _engine_run_backward(
[rank0]:              ^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/users/cmk2000/.conda/envs/dmog_env39/lib/python3.12/site-packages/torch/autograd/graph.py", line 768, in _engine_run_backward
[rank0]:     return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]: RuntimeError: One of the differentiated Tensors does not require grad