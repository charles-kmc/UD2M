Started ...
tensor(0.9988, device='cuda:0', grad_fn=<MaxBackward1>) tensor(1., device='cuda:0')
tensor(0.0030, device='cuda:0', grad_fn=<MinBackward1>) tensor(0., device='cuda:0')
Logging to /tmp/openai-2024-08-12-21-11-43-701772
Parameter module.time_embed.0.weight require grad
Parameter module.time_embed.0.bias require grad
Parameter module.time_embed.2.weight require grad
Parameter module.time_embed.2.bias require grad
Parameter module.input_blocks.0.weight require grad
Parameter module.input_blocks.0.bias require grad
Parameter module.input_blocks.1.0.in_layers.0.weight require grad
Parameter module.input_blocks.1.0.in_layers.0.bias require grad
Parameter module.input_blocks.1.0.in_layers.2.weight require grad
Parameter module.input_blocks.1.0.in_layers.2.bias require grad
Parameter module.input_blocks.1.0.out_layers.0.weight require grad
Parameter module.input_blocks.1.0.out_layers.0.bias require grad
Parameter module.input_blocks.1.0.out_layers.3.weight require grad
Parameter module.input_blocks.1.0.out_layers.3.bias require grad
Parameter module.input_blocks.2.0.in_layers.0.weight require grad
Parameter module.input_blocks.2.0.in_layers.0.bias require grad
Parameter module.input_blocks.2.0.in_layers.2.weight require grad
Parameter module.input_blocks.2.0.in_layers.2.bias require grad
Parameter module.input_blocks.2.0.out_layers.0.weight require grad
Parameter module.input_blocks.2.0.out_layers.0.bias require grad
Parameter module.input_blocks.2.0.out_layers.3.weight require grad
Parameter module.input_blocks.2.0.out_layers.3.bias require grad
Parameter module.input_blocks.3.0.in_layers.0.weight require grad
Parameter module.input_blocks.3.0.in_layers.0.bias require grad
Parameter module.input_blocks.3.0.in_layers.2.weight require grad
Parameter module.input_blocks.3.0.in_layers.2.bias require grad
Parameter module.input_blocks.3.0.out_layers.0.weight require grad
Parameter module.input_blocks.3.0.out_layers.0.bias require grad
Parameter module.input_blocks.3.0.out_layers.3.weight require grad
Parameter module.input_blocks.3.0.out_layers.3.bias require grad
Parameter module.input_blocks.4.0.in_layers.0.weight require grad
Parameter module.input_blocks.4.0.in_layers.0.bias require grad
Parameter module.input_blocks.4.0.in_layers.2.weight require grad
Parameter module.input_blocks.4.0.in_layers.2.bias require grad
Parameter module.input_blocks.4.0.out_layers.0.weight require grad
Parameter module.input_blocks.4.0.out_layers.0.bias require grad
Parameter module.input_blocks.4.0.out_layers.3.weight require grad
Parameter module.input_blocks.4.0.out_layers.3.bias require grad
Parameter module.input_blocks.5.0.in_layers.0.weight require grad
Parameter module.input_blocks.5.0.in_layers.0.bias require grad
Parameter module.input_blocks.5.0.in_layers.2.weight require grad
Parameter module.input_blocks.5.0.in_layers.2.bias require grad
Parameter module.input_blocks.5.0.out_layers.0.weight require grad
Parameter module.input_blocks.5.0.out_layers.0.bias require grad
Parameter module.input_blocks.5.0.out_layers.3.weight require grad
Parameter module.input_blocks.5.0.out_layers.3.bias require grad
Parameter module.input_blocks.5.0.skip_connection.weight require grad
Parameter module.input_blocks.5.0.skip_connection.bias require grad
Parameter module.input_blocks.6.0.in_layers.0.weight require grad
Parameter module.input_blocks.6.0.in_layers.0.bias require grad
Parameter module.input_blocks.6.0.in_layers.2.weight require grad
Parameter module.input_blocks.6.0.in_layers.2.bias require grad
Parameter module.input_blocks.6.0.out_layers.0.weight require grad
Parameter module.input_blocks.6.0.out_layers.0.bias require grad
Parameter module.input_blocks.6.0.out_layers.3.weight require grad
Parameter module.input_blocks.6.0.out_layers.3.bias require grad
Parameter module.input_blocks.7.0.in_layers.0.weight require grad
Parameter module.input_blocks.7.0.in_layers.0.bias require grad
Parameter module.input_blocks.7.0.in_layers.2.weight require grad
Parameter module.input_blocks.7.0.in_layers.2.bias require grad
Parameter module.input_blocks.7.0.out_layers.0.weight require grad
Parameter module.input_blocks.7.0.out_layers.0.bias require grad
Parameter module.input_blocks.7.0.out_layers.3.weight require grad
Parameter module.input_blocks.7.0.out_layers.3.bias require grad
Parameter module.input_blocks.8.0.in_layers.0.weight require grad
Parameter module.input_blocks.8.0.in_layers.0.bias require grad
Parameter module.input_blocks.8.0.in_layers.2.weight require grad
Parameter module.input_blocks.8.0.in_layers.2.bias require grad
Parameter module.input_blocks.8.0.out_layers.0.weight require grad
Parameter module.input_blocks.8.0.out_layers.0.bias require grad
Parameter module.input_blocks.8.0.out_layers.3.weight require grad
Parameter module.input_blocks.8.0.out_layers.3.bias require grad
Parameter module.input_blocks.9.0.in_layers.0.weight require grad
Parameter module.input_blocks.9.0.in_layers.0.bias require grad
Parameter module.input_blocks.9.0.in_layers.2.weight require grad
Parameter module.input_blocks.9.0.in_layers.2.bias require grad
Parameter module.input_blocks.9.0.out_layers.0.weight require grad
Parameter module.input_blocks.9.0.out_layers.0.bias require grad
Parameter module.input_blocks.9.0.out_layers.3.weight require grad
Parameter module.input_blocks.9.0.out_layers.3.bias require grad
Parameter module.input_blocks.9.0.skip_connection.weight require grad
Parameter module.input_blocks.9.0.skip_connection.bias require grad
Parameter module.input_blocks.10.0.in_layers.0.weight require grad
Parameter module.input_blocks.10.0.in_layers.0.bias require grad
Parameter module.input_blocks.10.0.in_layers.2.weight require grad
Parameter module.input_blocks.10.0.in_layers.2.bias require grad
Parameter module.input_blocks.10.0.out_layers.0.weight require grad
Parameter module.input_blocks.10.0.out_layers.0.bias require grad
Parameter module.input_blocks.10.0.out_layers.3.weight require grad
Parameter module.input_blocks.10.0.out_layers.3.bias require grad
Parameter module.input_blocks.11.0.in_layers.0.weight require grad
Parameter module.input_blocks.11.0.in_layers.0.bias require grad
Parameter module.input_blocks.11.0.in_layers.2.weight require grad
Parameter module.input_blocks.11.0.in_layers.2.bias require grad
Parameter module.input_blocks.11.0.out_layers.0.weight require grad
Parameter module.input_blocks.11.0.out_layers.0.bias require grad
Parameter module.input_blocks.11.0.out_layers.3.weight require grad
Parameter module.input_blocks.11.0.out_layers.3.bias require grad
Parameter module.middle_block.0.in_layers.0.weight require grad
Parameter module.middle_block.0.in_layers.0.bias require grad
Parameter module.middle_block.0.in_layers.2.weight require grad
Parameter module.middle_block.0.in_layers.2.bias require grad
Parameter module.middle_block.0.out_layers.0.weight require grad
Parameter module.middle_block.0.out_layers.0.bias require grad
Parameter module.middle_block.0.out_layers.3.weight require grad
Parameter module.middle_block.0.out_layers.3.bias require grad
Parameter module.output_blocks.0.0.in_layers.0.weight require grad
Parameter module.output_blocks.0.0.in_layers.0.bias require grad
Parameter module.output_blocks.0.0.in_layers.2.weight require grad
Parameter module.output_blocks.0.0.in_layers.2.bias require grad
Parameter module.output_blocks.0.0.out_layers.0.weight require grad
Parameter module.output_blocks.0.0.out_layers.0.bias require grad
Parameter module.output_blocks.0.0.out_layers.3.weight require grad
Parameter module.output_blocks.0.0.out_layers.3.bias require grad
Parameter module.output_blocks.0.0.skip_connection.weight require grad
Parameter module.output_blocks.0.0.skip_connection.bias require grad
Parameter module.output_blocks.1.0.in_layers.0.weight require grad
Parameter module.output_blocks.1.0.in_layers.0.bias require grad
Parameter module.output_blocks.1.0.in_layers.2.weight require grad
Parameter module.output_blocks.1.0.in_layers.2.bias require grad
Parameter module.output_blocks.1.0.out_layers.0.weight require grad
Parameter module.output_blocks.1.0.out_layers.0.bias require grad
Parameter module.output_blocks.1.0.out_layers.3.weight require grad
Parameter module.output_blocks.1.0.out_layers.3.bias require grad
Parameter module.output_blocks.1.0.skip_connection.weight require grad
Parameter module.output_blocks.1.0.skip_connection.bias require grad
Parameter module.output_blocks.1.1.in_layers.0.weight require grad
Parameter module.output_blocks.1.1.in_layers.0.bias require grad
Parameter module.output_blocks.1.1.in_layers.2.weight require grad
Parameter module.output_blocks.1.1.in_layers.2.bias require grad
Parameter module.output_blocks.1.1.out_layers.0.weight require grad
Parameter module.output_blocks.1.1.out_layers.0.bias require grad
Parameter module.output_blocks.1.1.out_layers.3.weight require grad
Parameter module.output_blocks.1.1.out_layers.3.bias require grad
Parameter module.output_blocks.2.0.in_layers.0.weight require grad
Parameter module.output_blocks.2.0.in_layers.0.bias require grad
Parameter module.output_blocks.2.0.in_layers.2.weight require grad
Parameter module.output_blocks.2.0.in_layers.2.bias require grad
Parameter module.output_blocks.2.0.out_layers.0.weight require grad
Parameter module.output_blocks.2.0.out_layers.0.bias require grad
Parameter module.output_blocks.2.0.out_layers.3.weight require grad
Parameter module.output_blocks.2.0.out_layers.3.bias require grad
Parameter module.output_blocks.2.0.skip_connection.weight require grad
Parameter module.output_blocks.2.0.skip_connection.bias require grad
Parameter module.output_blocks.3.0.in_layers.0.weight require grad
Parameter module.output_blocks.3.0.in_layers.0.bias require grad
Parameter module.output_blocks.3.0.in_layers.2.weight require grad
Parameter module.output_blocks.3.0.in_layers.2.bias require grad
Parameter module.output_blocks.3.0.out_layers.0.weight require grad
Parameter module.output_blocks.3.0.out_layers.0.bias require grad
Parameter module.output_blocks.3.0.out_layers.3.weight require grad
Parameter module.output_blocks.3.0.out_layers.3.bias require grad
Parameter module.output_blocks.3.0.skip_connection.weight require grad
Parameter module.output_blocks.3.0.skip_connection.bias require grad
Parameter module.output_blocks.3.1.in_layers.0.weight require grad
Parameter module.output_blocks.3.1.in_layers.0.bias require grad
Parameter module.output_blocks.3.1.in_layers.2.weight require grad
Parameter module.output_blocks.3.1.in_layers.2.bias require grad
Parameter module.output_blocks.3.1.out_layers.0.weight require grad
Parameter module.output_blocks.3.1.out_layers.0.bias require grad
Parameter module.output_blocks.3.1.out_layers.3.weight require grad
Parameter module.output_blocks.3.1.out_layers.3.bias require grad
Parameter module.model.input_blocks.9.1.qkv.parametrizations.weight.0.lora_A require grad
Parameter module.model.input_blocks.9.1.qkv.parametrizations.weight.0.lora_B require grad
Parameter module.model.input_blocks.9.1.proj_out.parametrizations.weight.0.lora_A require grad
Parameter module.model.input_blocks.9.1.proj_out.parametrizations.weight.0.lora_B require grad
Parameter module.model.middle_block.1.qkv.parametrizations.weight.0.lora_A require grad
Parameter module.model.middle_block.1.qkv.parametrizations.weight.0.lora_B require grad
Parameter module.model.middle_block.1.proj_out.parametrizations.weight.0.lora_A require grad
Parameter module.model.middle_block.1.proj_out.parametrizations.weight.0.lora_B require grad
Parameter module.model.output_blocks.2.1.qkv.parametrizations.weight.0.lora_A require grad
Parameter module.model.output_blocks.2.1.qkv.parametrizations.weight.0.lora_B require grad
Parameter module.model.output_blocks.2.1.proj_out.parametrizations.weight.0.lora_A require grad
Parameter module.model.output_blocks.2.1.proj_out.parametrizations.weight.0.lora_B require grad
Parameter module.model.output_blocks.3.1.qkv.parametrizations.weight.0.lora_A require grad
Parameter module.model.output_blocks.3.1.qkv.parametrizations.weight.0.lora_B require grad
Parameter module.model.output_blocks.3.1.proj_out.parametrizations.weight.0.lora_A require grad
Parameter module.model.output_blocks.3.1.proj_out.parametrizations.weight.0.lora_B require grad
Traceback (most recent call last):
  File "/users/cmk2000/cmk2000/Deep learning models/LLMs/Conditional-Diffusion-Models-for-IVP/main_training.py", line 90, in <module>
    main()
  File "/users/cmk2000/cmk2000/Deep learning models/LLMs/Conditional-Diffusion-Models-for-IVP/main_training.py", line 87, in main
    trainer.run_training_loop(num_epochs)
  File "/users/cmk2000/cmk2000/Deep learning models/LLMs/Conditional-Diffusion-Models-for-IVP/models/trainer.py", line 222, in run_training_loop
    self.run_epoch(batch_data, batch_sol_Tk, batch_y, blur_kernel_op)
  File "/users/cmk2000/cmk2000/Deep learning models/LLMs/Conditional-Diffusion-Models-for-IVP/models/trainer.py", line 254, in run_epoch
    self.run_forward_backward(batch_data, batch_sol_Tk, batch_y, blur_kernel_op)
  File "/users/cmk2000/cmk2000/Deep learning models/LLMs/Conditional-Diffusion-Models-for-IVP/models/trainer.py", line 299, in run_forward_backward
    x_pred.register_hook(print_grad)
                         ^^^^^^^^^^
NameError: name 'print_grad' is not defined
[rank0]: Traceback (most recent call last):
[rank0]:   File "/users/cmk2000/cmk2000/Deep learning models/LLMs/Conditional-Diffusion-Models-for-IVP/main_training.py", line 90, in <module>
[rank0]:     main()
[rank0]:   File "/users/cmk2000/cmk2000/Deep learning models/LLMs/Conditional-Diffusion-Models-for-IVP/main_training.py", line 87, in main
[rank0]:     trainer.run_training_loop(num_epochs)
[rank0]:   File "/users/cmk2000/cmk2000/Deep learning models/LLMs/Conditional-Diffusion-Models-for-IVP/models/trainer.py", line 222, in run_training_loop
[rank0]:     self.run_epoch(batch_data, batch_sol_Tk, batch_y, blur_kernel_op)
[rank0]:   File "/users/cmk2000/cmk2000/Deep learning models/LLMs/Conditional-Diffusion-Models-for-IVP/models/trainer.py", line 254, in run_epoch
[rank0]:     self.run_forward_backward(batch_data, batch_sol_Tk, batch_y, blur_kernel_op)
[rank0]:   File "/users/cmk2000/cmk2000/Deep learning models/LLMs/Conditional-Diffusion-Models-for-IVP/models/trainer.py", line 299, in run_forward_backward
[rank0]:     x_pred.register_hook(print_grad)
[rank0]:                          ^^^^^^^^^^
[rank0]: NameError: name 'print_grad' is not defined